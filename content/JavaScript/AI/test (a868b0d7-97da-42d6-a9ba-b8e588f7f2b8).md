# Authentication in Express.js #

Authentication is a crucial aspect of web applications, ensuring that users are who they claim to be. This guide demonstrates how to implement basic authentication in an Express.js application using JSON Web Tokens (JWT).

## Setup ##

First, install the necessary dependencies:

```bash
npm install express jsonwebtoken bcrypt
```

## Implementation ##

Here's a basic implementation of authentication in Express:

```javascript
const express = require('express')
const jwt = require('jsonwebtoken')
const bcrypt = require('bcrypt')

const app = express()
app.use(express.json())

const users = [] // In-memory user storage (replace with a database in production)
const SECRET_KEY = 'your-secret-key' // Use a strong, environment-specific secret in production

// User registration
app.post('/register', async (req, res) => {
  try {
    const { username, password } = req.body
    const hashedPassword = await bcrypt.hash(password, 10)
    users.push({ username, password: hashedPassword })
    res.status(201).send('User registered successfully')
  } catch (error) {
    res.status(500).send('Error registering user')
  }
})

// User login
app.post('/login', async (req, res) => {
  try {
    const { username, password } = req.body
    const user = users.find((u) => u.username === username)
    if (user && (await bcrypt.compare(password, user.password))) {
      const token = jwt.sign({ username }, SECRET_KEY, { expiresIn: '1h' })
      res.json({ token })
    } else {
      res.status(401).send('Invalid credentials')
    }
  } catch (error) {
    res.status(500).send('Error logging in')
  }
})

// Middleware to verify JWT
function authenticateToken(req, res, next) {
  const authHeader = req.headers['authorization']
  const token = authHeader && authHeader.split(' ')[1]
  if (token == null) return res.sendStatus(401)

  jwt.verify(token, SECRET_KEY, (err, user) => {
    if (err) return res.sendStatus(403)
    req.user = user
    next()
  })
}

// Protected route
app.get('/protected', authenticateToken, (req, res) => {
  res.json({ message: 'Access granted to protected route', user: req.user })
})

app.listen(3000, () => console.log('Server running on port 3000'))
```

## Usage ##

1. Register a user:

```bash
curl -X POST http://localhost:3000/register -H "Content-Type: application/json" -d '{"username":"user1", "password":"password123"}'
```

2. Login to get a token:

```bash
curl -X POST http://localhost:3000/login -H "Content-Type: application/json" -d '{"username":"user1", "password":"password123"}'
```

3. Access the protected route using the token:

```bash
curl http://localhost:3000/protected -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

## Security Considerations ##

- Use HTTPS in production to encrypt data in transit.
- Store passwords securely using strong hashing algorithms (bcrypt is used here).
- Implement proper error handling and logging.
- Use environment variables for sensitive information like SECRET_KEY.
- Consider implementing refresh tokens for better security.
- Add rate limiting to prevent brute-force attacks.

This basic authentication system demonstrates how to implement user registration, login, and route protection using JWT in an Express application.
Remember to store user data securely in a database and use environment variables for sensitive information like the SECRET_KEY in a production environment.
